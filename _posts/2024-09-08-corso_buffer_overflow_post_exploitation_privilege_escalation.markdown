---
layout: post
title:  "Corso Buffer Overflow: Post-Exploitation e Privilege Escalation"
date:   2024-09-08 17:00:00 +0200
categories: buffer-overflow
tags: [buffer-overflow, privilege-escalation, exploit, post-exploitation]
---

# Corso Buffer Overflow: Post-Exploitation e Privilege Escalation

Una volta che abbiamo sfruttato con successo un buffer overflow per ottenere una shell sulla macchina target, possiamo procedere con la fase di **post-exploitation**. Questo include la **raccolta di informazioni**, **escalation di privilegi**, e la creazione di un accesso persistente alla macchina compromessa.

In questa sezione esploreremo alcune tecniche di post-exploitation che puoi utilizzare per ottenere un controllo più profondo e stabile sulla macchina target.

## 1. Raccolta di Informazioni

Dopo aver ottenuto l'accesso alla macchina, il primo passo è raccogliere il maggior numero di informazioni possibili sul sistema compromesso. Alcuni comandi utili per iniziare sono:

### Comandi di base

```bash
whoami        # Per sapere con quale utente sei collegato
hostname      # Per conoscere il nome della macchina
id            # Per ottenere dettagli sull'utente e i gruppi
uname -a      # Informazioni sul sistema operativo
ifconfig      # Per ottenere informazioni sulle interfacce di rete
netstat -ano  # Per visualizzare le connessioni di rete attive
```

Queste informazioni ti permetteranno di pianificare i prossimi passi, inclusa l'escalation dei privilegi.

## 2. Privilege Escalation su Linux

Se hai ottenuto accesso con un utente non privilegiato, il tuo prossimo obiettivo è **escalare i privilegi** per ottenere accesso root.

### Tecniche comuni di Privilege Escalation

1. **Kernel Exploits**: Se il kernel della macchina è vulnerabile, puoi sfruttare vecchi exploit per ottenere l'accesso root. Utilizza strumenti come **searchsploit** per trovare exploit per versioni specifiche del kernel.

2. **Sudo Rights**: Controlla se l'utente corrente ha i diritti sudo per eseguire comandi come root senza una password:

   ```bash
   sudo -l
   ```

   Se trovi comandi che possono essere eseguiti con sudo senza password, puoi sfruttarli per ottenere privilegi root.

3. **File con SUID**: Cerca file con il bit SUID impostato, che vengono eseguiti con i privilegi del proprietario (spesso root):

   ```bash
   find / -perm -4000 2>/dev/null
   ```

   Alcuni file con SUID possono essere sfruttati per ottenere accesso root.

## 3. Privilege Escalation su Windows

Su Windows, ci sono molte tecniche per ottenere privilegi più elevati. Ecco alcune delle più comuni:

1. **Token Impersonation**: Se l'utente con cui hai ottenuto l'accesso è un amministratore, puoi impersonare un token privilegiato per ottenere accesso SYSTEM.

2. **Vulnerabilità del Servizio**: Cerca servizi configurati in modo errato che girano con privilegi elevati e prova a sfruttarli. Utilizza strumenti come **PowerUp** o **WinPEAS** per automatizzare la ricerca di vulnerabilità.

3. **Ricerca di Credenziali**: Cerca file di configurazione o script che contengono credenziali in chiaro o file con permessi deboli che puoi leggere.

## 4. Persistenza

Dopo aver ottenuto i privilegi elevati, è consigliabile configurare un metodo di **persistenza** per mantenere l'accesso alla macchina compromessa nel caso venga riavviata o la connessione venga persa.

### Tecniche comuni di persistenza

1. **Creare un nuovo utente**:

   ```bash
   useradd -m hacker
   passwd hacker
   usermod -aG sudo hacker  # Aggiungi l'utente al gruppo sudo
   ```

2. **Modificare la configurazione di SSH** per permettere l'accesso root:

   ```bash
   echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
   service ssh restart
   ```

3. **Installare una backdoor** persistente, come una reverse shell o un servizio che ti permette di connetterti nuovamente in futuro.

## 5. Esercizio Pratico

- Utilizza una macchina vulnerabile per provare ad eseguire l'escalation di privilegi su **Linux** o **Windows**.
- Configura un metodo di persistenza per mantenere l'accesso alla macchina compromessa.

## Conclusione

La fase di **post-exploitation** è cruciale per ottenere il massimo controllo su una macchina compromessa. Dopo aver eseguito l'escalation dei privilegi e configurato l'accesso persistente, sarai in una posizione più sicura per mantenere il controllo e continuare la tua attività di penetration testing.

Nel prossimo articolo, ci concentreremo sulle **esercitazioni pratiche** e su come utilizzare piattaforme come HackTheBox e TryHackMe per migliorare le tue abilità.

